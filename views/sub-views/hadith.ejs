<% 
	if (hadith.chapter)
		hadith.chapter.offset = Math.floor(hadith.numInChapter / global.MAX_PER_PAGE) * global.MAX_PER_PAGE;
	hashtag = (hadith.book.alias + '_' + hadith.num).replace(/[-\:]/, '_');
	var _e = (editable ? '_e' : '');
%>

<% if (hadith.title_en || site.admin) { %>
	<div class="col-12 h" lang="en">
		<h4 class="<%=_e%> fs-5" title="Ḥadīth Title" data-id="<%= hadith.id %>" data-prop="hadith.title_en"><%- hadith.title_en || `&hellip;` %></h4>
	</div>
<% } %>
<% if (site.admin) { %>
	<div class="col-12 h" lang="ar">
		<h4 class="fs-5" title="Ḥadīth Group"><strong>مجموعة: <span class="<%=_e%>" data-id="<%= hadith.id %>" data-prop="hadith.part"><%- hadith.part || `&hellip;` %></span></strong></h4>
	</div>
<% } %>
		
<% if (hadith.remark != 2) { // HADITH %>
<div class="col-md-6 col-sm-12 h" lang="en">
	<p>
		<%- (typeof rating !== 'undefined') ? `<span class="bi bi-reception-${rating}"></span>` : '' %>
		<%- hadith.verified ? `<span title="Verified Translation" class="bi bi-patch-check-fill"></span>` : '' %>
		<%- (hadith.numVirtual) ? `(${hadith.numVirtual})` : "" %>
		<b><a title="<%-hadith.id + ' (' + hadith.score + ')'%>" href="/<%=hadith.book.alias%>:<%=hadith.num%>"><%= `${hadith.book.shortName_en} ${hadith.num}` %></a></b> –
		<% if (hadith.chain_en || site.admin) { %>
			<span class="<%=_e%> chain" data-id="<%= hadith.id %>" data-prop="hadith.chain_en"><%- hadith.chain_en || `&hellip;` %></span>
		<% } %>
	</p>
	<div class="<%=_e%> body" data-id="<%= hadith.id %>" data-prop="hadith.body_en">
		<% if (!hadith.body_en) { %>
			<div class="cmd-tr">
				<br />
				<a href="<%- `/do/${hadith.id}?cmd=tr` %>" onclick="alert('Thanks! We\'re on it!');">Request/Fix</a> translation<br/>
				<a target="_blank" href="https://forms.gle/xPgw7eH1akjp3PPj9">Submit</a> a translation<br />
			</div>
		<% } %>
		<p><%- utils.emptyIfNull(hadith.body_en).replace(/\n/g, '</p><p>') || utils.emptyIfNull(hadith.text_en) %></p>
	</div>
	<% if (hadith.footnote_en || site.admin) { %>
		<div class="<%=_e%> footnote" data-id="<%= hadith.id %>" data-prop="hadith.footnote_en">
			<%- hadith.footnote_en || '&hellip;' %>
		</div>
	<% } %>
	<em class="grade">– <span title="Grade ID <%=hadith.grade.id%>" class="<%=_e%>" data-id="<%= hadith.id %>" data-prop="hadith.gradeId"><%- hadith.grade.grade_en %></span>&nbsp;(<span title="Grader ID <%=hadith.grader.id%>" class="<%=_e%>" data-id="<%= hadith.id %>" data-prop="hadith.graderId"><%- hadith.grader.shortName_en %></span>)</em>
	<% if ((title || hadith.numVirtual) && (hadith.chapter || hadith.section)) { %>
		<div class="title">
		§ 
		<% if (hadith.section) { %>
			<a href="/<%- `${hadith.book.alias}/${hadith.chapter.h1}?o=${hadith.chapter.offset}#${hadith.num}` %>" title="<%- hadith.section.title_en %>"><%- utils.truncate(hadith.section.title_en, 30, true) || 'Section' %></a>
		<% } %>
		<% if (hadith.chapter) { %>
			in <a href="/<%- `${hadith.book.alias}/${hadith.chapter.h1}` %>" title="<%- hadith.chapter.title_en %>"><%- utils.truncate(hadith.chapter.title_en, 30, true) || 'Chapter' %></a>
		<% } %>
		<a class="cmd-btn" title="Report an issue" href="<%- `/do/${hadith.id}?cmd=tr` %>" onclick="alert('Thanks! We\'re on it!');"><span class="bi bi-bug"></span></a>
		</div>
	<% } else { %>
		<a class="cmd-btn" title="Report an issue" href="<%- `/do/${hadith.id}?cmd=tr` %>" onclick="alert('Thanks! We\'re on it!');"><span class="bi bi-bug"></span></a>
	<% } %>
	<% if (hadith.tags || site.admin) {
		var tags = null;
		if (hadith.tags) {
			tags = hadith.tags.replace(/[{}]/g, '');
			tags = tags.split(/ +/).map(tag => {
				return `<a href="/tag/${tag}">${tag}</a>`;
			});
			tags = tags.join(' ');
		}
		%>
		<div class="tags">
			# <span class="<%=_e%>" data-id="<%= hadith.id %>" data-prop="hadith.tags"><%- tags || '&hellip;' %></span>
		</div>
	<% } %>
	<% if (main) { %>
		<div>
			<a href="https://twitter.com/intent/tweet?button_hashtag=<%=hashtag%>" class="twitter-hashtag-button" data-text="<%=hadith.title_en%>" data-hashtags="hadith,HadithoftheDay" data-size="I" data-show-count="true" data-url="https://hadith.quranunlocked.com/<%=hadith.book.alias%>:<%=hadith.num%>">Tweet #<%=hashtag%></a>
		</div>
	<% } %>
</div>
<div class="col-md-6 cols-sm-12 h" lang="ar">
	<p>
		<%- (hadith.numVirtual) ? `(${arabic.toArabicDigits(hadith.numVirtual+'')})` : "" %>
		<b><a title="<%-hadith.num0%>" href="/<%=hadith.book.alias%>:<%=hadith.num%>"><%= hadith.book.shortName %> <%= hadith.num_ar %></a></b> –
		<% if (hadith.chain || site.admin) { %>
			<span class="<%=_e%> chain" data-id="<%= hadith.id %>" data-prop="hadith.chain"><%- hadith.chain || '&hellip;' %></span>
		<% } %>
	</p>
	<div class="<%=_e%> body" data-id="<%= hadith.id %>" data-prop="hadith.body">
		<%- utils.emptyIfNull(hadith.body).replace(/\n/g, '</p><p>') %>
	</div>
	<% if (hadith.footnote || site.admin) { %>
		<div class="<%=_e%> footnote" data-id="<%= hadith.id %>" data-prop="hadith.footnote">
		<%- hadith.footnote || '&hellip;' %><br/>
		</div>
	<%  } %>
	<% if (hadith.grade.id != -1) { %>
	<em class="grade">– <%- hadith.grade.grade %>&nbsp;(<%- hadith.grader.shortName %>)</em>
	<%  } %>
	<% if ((title || hadith.numVirtual) && (hadith.chapter || hadith.section)) { %>
		<div class="title">
		§ 
		<% if (hadith.section) { %>
			<a href="/<%- `${hadith.book.alias}/${hadith.chapter.h1}?o=${hadith.chapter.offset}#${hadith.num}` %>" title="<%- hadith.section.title %>"><%- utils.truncate(hadith.section.title, 60, true) || 'بَاب' %></a>
		<% } %>
		<% if (hadith.chapter) { %>
			في <a href="/<%- `${hadith.book.alias}/${hadith.chapter.h1}` %>" title="<%- hadith.chapter.title %>"><%- utils.truncate(hadith.chapter.title, 60, true) || 'كِتَاب' %></a>
		<% } %>
		</div>
	<% } %>
</div>

<% } else { // QURAN %>

<div class="col-md-6 col-sm-12 h" lang="en">
	<% if (hadith.chain_en) { %>
		<p>
			<%- (typeof rating !== 'undefined') ? `<span class="bi bi-reception-${rating}"></span>` : '' %>
			<b><a href="/<%=hadith.book.alias%>:<%=hadith.num%>"><%= `${hadith.book.shortName_en} ${hadith.num}` %></a></b> –
			<span class="<%=_e%> chain" data-id="<%=hadith.id%>" data-prop="hadith.chain_en"><%- hadith.chain_en %></span>
		</p>
		<div class="<%=_e%> body" data-id="<%=hadith.id%>" data-prop="hadith.body_en">
			<p><%- (hadith.body_en+'').replace(/\n/g, '</p><p>') %></p>
		</div>
	<% } else { %>
		<div>
			<%- (typeof rating !== 'undefined') ? `<span class="bi bi-reception-${rating}"></span>` : '' %>
			<b><a href="/<%=hadith.book.alias%>:<%=hadith.num%>"><%= `${hadith.book.shortName_en} ${hadith.num}` %></a></b> –
			<span class="<%=_e%> chain" data-id="<%=hadith.id%>" data-prop="hadith.chain_en"><%- hadith.chain_en %></span>
			<span class="<%=_e%>" data-id="<%=hadith.id%>" data-prop="hadith.body_en"><%- (hadith.body_en+'') %></span>
			<a class="cmd-btn" title="Report an issue" href="<%- `/do/${hadith.id}?cmd=tr` %>" onclick="alert('Thanks! We\'re on it!');"><span class="bi bi-bug"></span></a>
			<br />
		</div>
	<% } %>
	<% if (hadith.footnote_en || site.admin) { %>
		<div class="<%=_e%> footnote" data-id="<%= hadith.id %>" data-prop="hadith.footnote_en">
			<%- hadith.footnote_en || '&hellip;' %>
		</div>
	<% } %>
	<% if (title || hadith.numVirtual) { %>
		<div class="title">
			§ <a href="/<%- `${hadith.book.alias}/${hadith.chapter.h1}?o=${hadith.chapter.offset}#${hadith.num}` %>" title="<%- hadith.section.title_en %>"><%- utils.truncate(hadith.section.title_en, 30, true) || 'Section' %></a>
			in <a href="/<%- `${hadith.book.alias}/${hadith.chapter.h1}` %>" title="<%- hadith.chapter.title_en %>"><%- utils.truncate(hadith.chapter.title_en, 30, true) || 'Chapter' %></a>
		</div>
	<% } %>
	<% if (hadith.tags || site.admin) {
		var tags = null;
		if (hadith.tags) {
			tags = hadith.tags.replace(/[{}]/g, '');
			tags = tags.split(/ +/).map(tag => {
				return `<a href="/tag/${tag}">${tag}</a>`;
			});
			tags = tags.join(' ');
		}
		%>
		<div class="tags">
			# <span class="<%=_e%>" data-id="<%= hadith.id %>" data-prop="hadith.tags"><%- tags || '&hellip;' %></span>
		</div>
	<% } %>
	<% if (main) { %>
		<div>
			<a href="https://twitter.com/intent/tweet?button_hashtag=<%=hashtag%>" class="twitter-hashtag-button" data-text="<%=hadith.title_en%>" data-hashtags="hadith" data-size="I" data-show-count="true" data-url="https://hadith.quranunlocked.com/<%=hadith.book.alias%>:<%=hadith.num%>">Tweet #<%=hashtag%></a>
		</div>
	<% } %>
</div>
<div class="col-md-6 cols-sm-12 h" lang="ar">
	<% if (hadith.chain) { %>
		<p>
			<b><a href="/<%=hadith.book.alias%>:<%=hadith.num%>"><%= `${hadith.book.shortName} ${hadith.num_ar}` %></a></b> –
			<span class="chain"><%- hadith.chain %></span>
		</p>
		<p class="body">
			<%- (hadith.body+'').replace(/\n/g, '</p><p class="body">') %>&nbsp;۝<br />
		</p>
	<% } else { %>
		<p>
			<b><a href="/<%=hadith.book.alias%>:<%=hadith.num%>"><%= `${hadith.book.shortName} ${hadith.num_ar}` %></a></b> –
			<span class="chain"><%- hadith.chain %></span>
			<%- (hadith.body+'').replace(/\n/g, '</p><p class="body">') %>&nbsp;۝<br />
		</p>
	<% } %>
	<% if (hadith.footnote) { %>
		<p class="footnote">
		<%- hadith.footnote %><br/>
		</p>
	<%  } %>
	<% if (title || hadith.numVirtual) { %>
		<div class="title">
			§ <a href="/<%- `${hadith.book.alias}/${hadith.chapter.h1}?o=${hadith.chapter.offset}#${hadith.num}` %>" title="<%- hadith.section.title %>"><%- utils.truncate(hadith.section.title, 60, true) || 'بَاب' %></a>
			في <a href="/<%- `${hadith.book.alias}/${hadith.chapter.h1}` %>" title="<%- hadith.chapter.title %>"><%- utils.truncate(hadith.chapter.title, 60, true) || 'كِتَاب' %></a>
		</div>
	<% } %>
</div>

<% } %>

<% if (title) { %>
	<hr class="mt-2" />
<% } else { %>
	<div class="mt-2"></div>
<% } %>
